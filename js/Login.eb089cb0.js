(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{"0866":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("header",{staticClass:"header v-center"},[e.$app.logoPath?e._m(0):e._e(),t("h1",{staticClass:"header-title v-to-zero"},[e._v(e._s(e.title))])]),t("main",[t("AForm",{staticClass:"login-form",attrs:{form:e.loginForm},on:{submit:function(s){return s.preventDefault(),e.login(s)}}},[t("AFormItem",[t("AInput",{directives:[{name:"decorator",rawName:"v-decorator",value:e.getRules("username"),expression:"getRules('username')"}],attrs:{placeholder:"用户名:",size:"large"},on:{pressEnter:function(s){return s.preventDefault(),e.setPasswordFocus(!0)},focus:function(s){return e.setPasswordFocus(!1)}}},[t("AIcon",{staticClass:"login-form-icon",attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("AFormItem",[t("AInput",{directives:[{name:"decorator",rawName:"v-decorator",value:e.getRules("password"),expression:"getRules('password')"},{name:"focus",rawName:"v-focus",value:e.passwordFocus,expression:"passwordFocus"}],attrs:{type:"password",size:"large",placeholder:"密码:"}},[t("AIcon",{staticClass:"login-form-icon",attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("AFormItem",[t("ACheckbox",{directives:[{name:"decorator",rawName:"v-decorator",value:e.getRules("remember"),expression:"getRules('remember')"}]},[e._v("自动登录")]),t("a",{staticClass:"login-form-forgot",attrs:{href:""}},[e._v("忘记密码")]),t("AButton",{attrs:{loading:e.loading,size:"large",type:"primary","html-type":"submit",block:""}},[e._v("登录")])],1)],1)],1)])},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("img",{staticClass:"header-logo",attrs:{src:e.publicPath+e.$app.logoPath,alt:"logo",height:"46"}})}],o=t("2f62"),i=t("ba41"),l=t("fd4e"),n={name:"Login",directives:{focus(e,{value:s}){if(s){const s=Array.prototype.find,t=s.call(e.childNodes,e=>"input"===e.localName);t&&t.focus()}}},data(){return{title:this.$app.title.main,publicPath:"",loading:!1,passwordFocus:!1}},beforeCreate(){this.loginForm=this.$form.createForm(this)},created(){this.login=Object(l["d"])(this.login,360),this.setRules()},methods:{...Object(o["b"])("user",["handleLogin"]),login(){this.loginForm.validateFieldsAndScroll((e,s)=>{e||(this.loading=!0,this.clearDB(),this.handleLogin(s).then(()=>{this.$router.push({name:this.$app.mainName}),this.loading=!1}).catch(e=>{this.loading=!1,this.$message.error(e.msg)}))})},setRules(){this.rulesForm={username:{initialValue:"admin",validateFirst:!0,normalize:e=>e?e.toString().trim():null,rules:[{required:!0,whitespace:!0,message:"请输入你的用户名!"},{min:4,message:"不少于4个字符"},{max:30,message:"不超过30个字符"},{validator:this.validateToPassword}]},password:{initialValue:"admin-template",validateFirst:!0,normalize:e=>e?e.toString().trim():null,rules:[{required:!0,whitespace:!0,message:"请输入你的密码!"},{min:5,message:"不少于5个字符"},{max:45,message:"不超过45个字符"},{validator:this.compareToUsername}]},remember:{valuePropName:"checked",initialValue:!0}}},getRules(e){return[e,this.rulesForm[e]]},setPasswordFocus(e){this.passwordFocus=e},compareToUsername(e,s,t){if(s===this.loginForm.getFieldValue("username"))return t(new Error("密码不能和用户名重复"));t()},validateToPassword(e,s,t){s&&this.loginForm.getFieldValue("password")&&this.loginForm.validateFields(["password"],{force:!0}),t()},clearDB(e){this.isClearDB||i["b"].get(i["a"].USER_INFO,{}).username===e||(i["b"].clear(),this.isClearDB=!0)}}},c=n,m=(t("7058"),t("2877")),u=Object(m["a"])(c,a,r,!1,null,"79056ee0",null);s["default"]=u.exports},7058:function(e,s,t){"use strict";t("c8eb")},c8eb:function(e,s,t){}}]);